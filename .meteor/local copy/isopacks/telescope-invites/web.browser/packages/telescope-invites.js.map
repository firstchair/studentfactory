{"version":3,"sources":["telescope-invites//Users/lukasfeitsma/Documents/Studie/CMD/Jaar2/Blok4/Project-X/klussenbank/packages/telescope-invites/package-tap.i18n","telescope-invites/lib/invites.js","telescope-invites/lib/client/templates/user_invites.html","telescope-invites/lib/client/templates/user_invites.js","telescope-invites//Users/lukasfeitsma/Documents/Studie/CMD/Jaar2/Blok4/Project-X/klussenbank/packages/telescope-invites/i18n/de.i18n.json","telescope-invites//Users/lukasfeitsma/Documents/Studie/CMD/Jaar2/Blok4/Project-X/klussenbank/packages/telescope-invites/i18n/en.i18n.json","telescope-invites//Users/lukasfeitsma/Documents/Studie/CMD/Jaar2/Blok4/Project-X/klussenbank/packages/telescope-invites/i18n/es.i18n.json","telescope-invites//Users/lukasfeitsma/Documents/Studie/CMD/Jaar2/Blok4/Project-X/klussenbank/packages/telescope-invites/i18n/fr.i18n.json","telescope-invites//Users/lukasfeitsma/Documents/Studie/CMD/Jaar2/Blok4/Project-X/klussenbank/packages/telescope-invites/i18n/it.i18n.json","telescope-invites//Users/lukasfeitsma/Documents/Studie/CMD/Jaar2/Blok4/Project-X/klussenbank/packages/telescope-invites/i18n/zh-CN.i18n.json"],"names":[],"mappings":";;;;;;;;AAAA,mH;;AAEA,+D;AACA,gD;AACA,2C;AACA,6E;AACA,uH;;AAEA,qD;AACA,6B;AACA,yC;;;;;;;;;;;;;;;;;;;ACVA,iC;AACA,Q;AACA,iB;AACA,kB;AACA,I;AACA,mB;AACA,iB;AACA,kB;AACA,I;AACA,qB;AACA,iB;AACA,mC;AACA,I;AACA,a;AACA,kB;AACA,kB;AACA,G;AACA,G;;AAEA,2C;AACA,mC;;AAEA,4C;;AAEA,c;AACA,qC;AACA,qC;AACA,oC;AACA,G;;AAEA,sB;AACA,0B;AACA,U;AACA,G;;AAEA,qC;AACA,gD;AACA,0D;AACA,c;AACA,C;AACA,8C;;AAEA,gC;AACA,qC;AACA,0D;AACA,yC;AACA,wE;AACA,e;AACA,4E;;AAEA,6B;AACA,wB;AACA,iC;AACA,gD;AACA,S;;AAEA,0C;AACA,uB;AACA,U;AACA,K;AACA,G;AACA,c;AACA,C;AACA,0C;;;;;;;;;;;;;;;;;;;;AC9DA,oC;AACA,4E;AACA,kB;AACA,mB;AACA,iD;AACA,0E;AACA,+D;AACA,iB;AACA,yD;AACA,c;AACA,6D;AACA,yC;AACA,8C;AACA,uC;AACA,kD;AACA,Q;AACA,mB;AACA,4E;AACA,kF;AACA,kC;AACA,0E;AACA,6B;AACA,6D;AACA,kB;AACA,oD;AACA,Y;AACA,uB;AACA,wE;AACA,oE;AACA,iC;AACA,gD;AACA,uF;AACA,oC;AACA,c;AACA,uB;AACA,uE;AACA,wC;AACA,yB;AACA,4B;AACA,yB;AACA,wC;AACA,S;AACA,mB;AACA,2O;AACA,kD;AACA,iB;AACA,iH;AACA,iE;AACA,wD;AACA,qD;AACA,mB;AACA,qB;AACA,6B;AACA,S;AACA,2C;AACA,wC;AACA,I;;;;;;;;;;;;;;;;;;;ACzDA,4D;;AAEA,uB;AACA,sB;;AAEA,yC;;AAEA,8B;AACA,qD;AACA,2D;AACA,kC;AACA,K;AACA,E;;AAEA,8C;AACA,qC;AACA,oC;AACA,mF;AACA,I;AACA,4B;AACA,oC;AACA,qD;AACA,I;AACA,8B;AACA,mD;AACA,wB;AACA,I;AACA,wB;AACA,6C;AACA,G;AACA,G;;AAEA,0B;AACA,8B;AACA,sC;AACA,+D;AACA,K;AACA,E;;AAEA,gB;AACA,e;AACA,sD;AACA,2B;;AAEA,mC;AACA,6E;AACA,c;AACA,6C;AACA,O;AACA,iB;AACA,M;;AAEA,mD;AACA,2B;;AAEA,gC;AACA,8C;AACA,mB;AACA,O;AACA,K;AACA,G;AACA,G;;;;;;;;;;;;;;;;;;;AC7DA,6B;AACA,uC;AACA,oC;;AAEA,gC;AACA,yD;AACA,C;AACA,8E;;AAEA,oD;AACA,8C;;AAEA,yC;AACA,C;;;;;;;;;;;;;;;;;;;ACbA,6B;AACA,uC;AACA,oC;;AAEA,gC;AACA,yD;AACA,C;AACA,gD;AACA,kB;AACA,mE;AACA,gD;;;;;;;;;;;;;;;;;;;ACVA,6B;AACA,uC;AACA,oC;;AAEA,gC;AACA,yD;AACA,C;;;;;;;;;;;;;;;;;;;ACNA,6B;AACA,uC;AACA,oC;;AAEA,gC;AACA,yD;AACA,C;;;;;;;;;;;;;;;;;;;ACNA,6B;AACA,uC;AACA,oC;;AAEA,gC;AACA,yD;AACA,C;;;;;;;;;;;;;;;;;;;ACNA,6B;AACA,uC;AACA,oC;;AAEA,gC;AACA,yD;AACA,C","file":"/packages/telescope-invites.js","sourcesContent":["TAPi18n.packages[\"telescope-invites\"] = {\"translation_function_name\":\"__\",\"helper_name\":\"_\",\"namespace\":\"project\"};\n\n// define package's translation function (proxy to the i18next)\n__ = TAPi18n._getPackageI18nextProxy(\"project\");\n// define the package's templates registrar\nregisterI18nTemplate = TAPi18n._getRegisterHelpersProxy(\"telescope-invites\");\nregisterTemplate = registerI18nTemplate; // XXX OBSOLETE, kept for backward compatibility will be removed in the future\n\n// Record the list of templates prior to package load\nvar _ = Package.underscore._;\nnon_package_templates = _.keys(Template);\n","InviteSchema = new SimpleSchema({\n  _id: {\n    type: String,\n    optional: true\n  },\n  invitingUserId: {\n    type: String,\n    optional: true\n  },\n  invitedUserEmail: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  },\n  accepted: {\n    type: Boolean,\n    optional: true\n  }\n});\n\nInvites = new Meteor.Collection(\"invites\");\nInvites.attachSchema(InviteSchema);\n\n// invites are managed through Meteor method\n\nInvites.deny({\n  insert: function(){ return true; },\n  update: function(){ return true; },\n  remove: function(){ return true; }\n});\n\nuserProfileEdit.push({\n  template: 'userInvites',\n  order: 2\n});\n\n function setStartingInvites (user) {\n  // give new users a few invites (default to 3)\n  user.inviteCount = Settings.get('startInvitesCount', 3);\n  return user;\n}\nuserCreatedCallbacks.push(setStartingInvites);\n\nfunction checkIfInvited (user) {\n  // if the new user has been invited\n  // set her status accordingly and update invitation info\n  if(invitesEnabled() && getEmail(user)){\n    var invite = Invites.findOne({ invitedUserEmail : getEmail(user) });\n    if(invite){\n      var invitedBy = Meteor.users.findOne({ _id : invite.invitingUserId });\n\n      user = _.extend(user, {\n        isInvited: true,\n        invitedBy: invitedBy._id,\n        invitedByName: getDisplayName(invitedBy)\n      });\n\n      Invites.update(invite._id, {$set : {\n        accepted : true\n      }});\n    }\n  }\n  return user;\n}\nuserCreatedCallbacks.push(checkIfInvited);\n","\nTemplate.__checkName(\"userInvites\");\nTemplate[\"userInvites\"] = new Template(\"Template.userInvites\", (function() {\n  var view = this;\n  return HTML.DIV({\n    \"class\": \"grid-small grid-block dialog admin\"\n  }, HTML.Raw(\"\\n    <h2>Invites</h2>\\n    \\n    \"), Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"canCurrentUserInvite\"));\n  }, function() {\n    return [ \"\\n      \", Blaze._TemplateWith(function() {\n      return {\n        schema: Spacebars.call(view.lookup(\"invitesSchema\")),\n        id: Spacebars.call(\"inviteForm\"),\n        \"class\": Spacebars.call(\"form-block\"),\n        type: Spacebars.call(\"method\"),\n        meteormethod: Spacebars.call(\"inviteUser\")\n      };\n    }, function() {\n      return Spacebars.include(view.lookupTemplate(\"autoForm\"), function() {\n        return [ \"\\n        \", HTML.H3(\"Invite someone\"), \"\\n        \", HTML.DIV({\n          \"class\": \"control-group\"\n        }, \"\\n          \", HTML.LABEL(\"Email\"), \"\\n          \", HTML.DIV({\n          \"class\": \"controls\"\n        }, \"\\n            \", Blaze._TemplateWith(function() {\n          return {\n            name: Spacebars.call(\"invitedUserEmail\")\n          };\n        }, function() {\n          return Spacebars.include(view.lookupTemplate(\"afFieldInput\"));\n        }), \"\\n          \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n          \"class\": \"form-actions\"\n        }, \"\\n          \", Blaze.If(function() {\n          return Spacebars.dataMustache(view.lookup(\"afFieldIsInvalid\"), Spacebars.kw({\n            name: \"invitedUserEmail\"\n          }));\n        }, function() {\n          return \"\\n            This is not a valid email\\n          \";\n        }), \"\\n          \", HTML.INPUT({\n          type: \"submit\",\n          \"class\": \"button\",\n          value: \"Invite\"\n        }), \"\\n        \"), \"\\n      \" ];\n      });\n    }), \"\\n    \" ];\n  }), \"\\n\\n    \", HTML.TABLE(\"\\n      \", HTML.THEAD(\"\\n        \", HTML.TR(\"\\n          \", HTML.TD(\"Email\"), \"\\n          \", HTML.TD(\"Accepted\"), \"\\n        \"), \"\\n      \"), \"\\n      \", HTML.TBODY(\"\\n          \", Blaze.Each(function() {\n    return Spacebars.call(view.lookup(\"invites\"));\n  }, function() {\n    return [ \"\\n          \", HTML.TR(\"\\n            \", HTML.TD(Blaze.View(\"lookup:invitedUserEmail\", function() {\n      return Spacebars.mustache(view.lookup(\"invitedUserEmail\"));\n    })), \"\\n            \", HTML.TD(Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"accepted\"));\n    }, function() {\n      return HTML.I({\n        \"class\": \"icon-check\"\n      });\n    })), \"\\n          \"), \"\\n          \" ];\n  }), \"\\n      \"), \"\\n    \"), \"\\n\\n  \");\n}));\n","Template[getTemplate('userInvites')].created = function () {\n\n  var user = this.data;\n  var instance = this;\n\n  instance.invites = new ReactiveVar({});\n\n  Meteor.autorun(function () {\n    coreSubscriptions.subscribe('invites', user._id);\n    var invites = Invites.find({invitingUserId: user._id});\n    instance.invites.set(invites);\n  });\n};\n\nTemplate[getTemplate('userInvites')].helpers({\n  canCurrentUserInvite: function () {\n    var currentUser = Meteor.user();\n    return currentUser && (currentUser.inviteCount > 0 && can.invite(currentUser));\n  },\n  invitesLeft: function () {\n    var currentUser = Meteor.user();\n    return currentUser ? currentUser.inviteCount : 0;\n  },\n  invitesSchema: function () {\n    // expose schema for Invites (used by AutoForm)\n    return InviteSchema;\n  },\n  invites: function () {\n    return Template.instance().invites.get();\n  }\n});\n\nvar scrollUp = function(){\n  Deps.afterFlush(function() {\n    var element = $('.grid > .error');\n    $('html, body').animate({scrollTop: element.offset().top});\n  });\n};\n\nAutoForm.hooks({\n  inviteForm: {\n    onSuccess: function(operation, result, template) {\n      Messages.clearSeen();\n\n      if(result && result.newUser){\n        Messages.flash('An invite has been sent out. Thank you!', \"success\");\n      } else {\n        Messages.flash('Thank you!', \"info\");\n      }\n      scrollUp();\n    },\n\n    onError: function(operation, error, template) {\n      Messages.clearSeen();\n\n      if(error && error.reason){\n        Messages.flash(error.reason, \"error\");\n        scrollUp();\n      }\n    }\n  }\n});\n","var _ = Package.underscore._,\n    package_name = \"telescope-invites\",\n    namespace = \"telescope-invites\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\nvar package_templates = _.difference(_.keys(Template), non_package_templates);\n\nfor (var i = 0; i < package_templates.length; i++) {\n  var package_template = package_templates[i];\n\n  registerI18nTemplate(package_template);\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope-invites\",\n    namespace = \"telescope-invites\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n// integrate the fallback language translations \ntranslations = {};\ntranslations[namespace] = {\"translation_key\":\"translation string\"};\nTAPi18n._loadLangFileObject(\"en\", translations);\n","var _ = Package.underscore._,\n    package_name = \"telescope-invites\",\n    namespace = \"telescope-invites\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope-invites\",\n    namespace = \"telescope-invites\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope-invites\",\n    namespace = \"telescope-invites\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope-invites\",\n    namespace = \"telescope-invites\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n"]}